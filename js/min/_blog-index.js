function inViewport(){var a=$(window).innerHeight()+$(window).scrollTop();$.each($("#loop article"),function(){var b=parseInt($(this).offset().top,10);a>b?$(this).addClass("shown"):$(this).removeClass("shown")})}function filterPosts(){var a=$("#language-handle").data("lang");if("all"!==a)var b=".lang-"+a;else var b="article";var c=$("#tweet-filter").prop("checked");if(c)var d="";else var d=":not(.index-tweet)";return $("#loop").isotope({filter:b+d}),setTimeout(function(){inViewport()},300),!1}var pathname=window.location.pathname,tagID=$.urlParam("tag");pathname.match("^/blog")&&!pathname.match("blog/$")?window.location.href="/blog/":tagID&&window.location.replace("./"),$(window).on("load",function(){var a=!1;document.referrer.match("^(https?://)(www.)?([a-zA-Z0-9-.]*)(/blog)(.*)")&&(a=!0),$("#loop").isotope({itemSelector:"article"}),setTimeout(function(){inViewport(),$("#loop").removeClass("preload")},200),$.ajax({type:"POST",url:ajaxurl,data:{action:"quan_get_all_posts"},success:function(b){$("#loop").isotope("insert",$(b));setTimeout(function(){$("#loop").isotope({itemSelector:"article"}).imagesLoaded(function(){$(this).isotope({itemSelector:"article"})}),inViewport(),$.cookie("scrollTop")&&a===!0&&($("html, body").animate({scrollTop:$.cookie("scrollTop")},.1*$.cookie("scrollTop")),$.removeCookie("scrollTop"))},300)}})}),$(document).ready(function(){$(".filter").show(),$("#language-handle").text($("#language-options div:first-of-type").text()).data("lang","all").on("click",function(){$("#language-filter").toggleClass("active")}),$("#language-options .option").on("click",function(){$("#language-handle").data("lang",$(this).data("lang")),$("#language-handle").text($(this).text()),filterPosts(),$("#language-filter").toggleClass("active")}),$("#tweet-filter").on("change",function(){filterPosts()})}),$(document).on("mouseover","#loop article",function(){$(this).addClass("focus").css("cursor","pointer"),$(this).siblings().addClass("unfocus")}).on("mouseleave","#loop article",function(){$(this).removeClass("focus"),$(this).siblings().removeClass("unfocus")}).on("click",".index-post",function(){window.location=$(this).find(".postlink").attr("href")}),$(window).smartresize(function(){$("#loop").isotope({itemSelector:"article"}),inViewport()}),$(document).on("scroll",function(){inViewport(),$("#loop article").each(function(){$(this).removeClass("unfocus")})}),window.onbeforeunload=function(){$.cookie("scrollTop",$(window).scrollTop())};